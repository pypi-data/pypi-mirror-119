(this["webpackJsonpsupervisor-react"]=this["webpackJsonpsupervisor-react"]||[]).push([[0],{163:function(e,t){},165:function(e,t){},196:function(e,t,r){"use strict";r.r(t);var n,s=r(0),c=r(39),o=r.n(c),a=r(13),i=r(45),u=r(108),l=(r(153),r(154),r(155),r(156),r(59)),j=r.n(l),p=r(272),h=r(265),d=r(130),x=r.n(d),O=r(106),b=r.n(O),f=r(283),m=r(282),v=r(267),P=r(271),g=r(269),N=r(262),A=r(281),w=r(274),C=r(266),S=r(280),I=r(107),G=r.n(I),T=r(258),k=r(128),R=r.n(k),F=r(261),y=r(268),E=r(132),U=r.n(E),L=r(129),z=r.n(L),D=r(131),B=r.n(D),K=r(259),M=r(276),W=r(277),H=r(279),V=r(275),X=r(278),J=r(273),q=r(256),Q=r(270),Y=r(15),Z=r.n(Y),$=r(23),_=r(82),ee=r(158);!function(e){e[e.STOPPED=0]="STOPPED",e[e.STARTING=10]="STARTING",e[e.RUNNING=20]="RUNNING",e[e.BACKOFF=30]="BACKOFF",e[e.STOPPING=40]="STOPPING",e[e.EXITED=100]="EXITED",e[e.FATAL=200]="FATAL",e[e.UNKNOWN=1e3]="UNKNOWN"}(n||(n={}));n.STOPPED,n.EXITED,n.FATAL,n.UNKNOWN;var te,re=[n.RUNNING,n.BACKOFF,n.STARTING];!function(e){e[e.FATAL=2]="FATAL",e[e.RUNNING=1]="RUNNING",e[e.RESTARTING=0]="RESTARTING",e[e.SHUTDOWN=-1]="SHUTDOWN"}(te||(te={}));var ne=function e(t){var r=this;Object(_.a)(this,e),this.client=void 0,this.setProcesses=void 0,this.methodCall=function(e,t){return new Promise((function(n,s){return r.client.methodCall(e,t,(function(e,t){return e?s(e):n(t)}))}))},this.getSupervisorVersion=function(){return r.methodCall("supervisor.getSupervisorVersion",[])},this.getState=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.getState",[]);case 2:return e.abrupt("return",e.sent.statename);case 3:case"end":return e.stop()}}),e)}))),this.getAllProcessInfo=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=r,e.next=4,r.methodCall("supervisor.getAllProcessInfo",[]);case 4:e.t1=e.sent,e.t0.setProcesses.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),r.setProcesses([]);case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))),this.startProcess=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.startProcess",["".concat(t.group,":").concat(t.name)]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.startProcessGroup=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.startProcessGroup",[t]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.startAllProcesses=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.startAllProcesses",[]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)}))),this.stopProcess=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.stopProcess",["".concat(t.group,":").concat(t.name)]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.stopProcessGroup=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.stopProcessGroup",[t]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.stopAllProcesses=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.methodCall("supervisor.stopAllProcesses",[]);case 2:return e.next=4,r.getAllProcessInfo();case 4:case"end":return e.stop()}}),e)}))),this.restartProcess=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!re.includes(t.state)){e.next=4;break}return e.next=4,r.stopProcess(t);case 4:return e.prev=4,e.next=7,r.startProcess(t);case 7:return e.finish(4);case 8:case"end":return e.stop()}}),e,null,[[0,,4,8]])})));return function(t){return e.apply(this,arguments)}}(),this.restartProcessGroup=function(){var e=Object($.a)(Z.a.mark((function e(t){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.stopProcessGroup(t);case 2:return e.next=4,r.startProcessGroup(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.restartAllProcesses=Object($.a)(Z.a.mark((function e(){return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.stopAllProcesses();case 2:return e.next=4,r.startAllProcesses();case 4:case"end":return e.stop()}}),e)}))),this.clearProcessLogs=function(e){return r.methodCall("supervisor.clearProcessLogs",["".concat(e.group,":").concat(e.name)])},this.clearAllProcessLogs=function(){return r.methodCall("supervisor.clearAllProcessLogs",[])},this.client=ee.createClient({host:window.location.hostname,port:window.location.port,path:"/RPC2"}),this.setProcesses=t},se=r(2),ce=["title"],oe=["supervisor"],ae=function(e){var t=e.title,r=Object(u.a)(e,ce);return Object(se.jsx)(q.a,{title:t,children:Object(se.jsx)(h.a,{component:"span",children:Object(se.jsx)(C.a,Object(i.a)({},r))})})},ie=function(e){var t=e.supervisor,r=Object(u.a)(e,oe),n=Object(s.useState)(""),c=Object(a.a)(n,2),o=c[0],l=c[1];return Object(s.useEffect)((function(){t.getSupervisorVersion().then(l)}),[]),Object(se.jsxs)(v.a,Object(i.a)(Object(i.a)({},r),{},{children:[Object(se.jsx)(g.a,{children:"About"}),Object(se.jsx)(P.a,{dividers:!0,children:Object(se.jsxs)("ul",{children:[Object(se.jsxs)("li",{children:["supervisor: ",o]}),Object(se.jsx)("li",{children:"supervisor-react: 0.1.3"})]})})]}))},ue=function(e){var t=e.supervisor,r=Object(s.useState)(null),n=Object(a.a)(r,2),c=n[0],o=n[1],i=Object(s.useState)(!1),u=Object(a.a)(i,2),l=u[0],j=u[1];return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(p.a,{position:"static",children:Object(se.jsxs)(J.a,{children:[Object(se.jsx)(C.a,{color:"inherit",onClick:function(e){return o(e.currentTarget)},children:Object(se.jsx)(R.a,{})}),Object(se.jsxs)(T.a,{anchorEl:c,open:null!==c,onClose:function(){return o(null)},children:[Object(se.jsx)(F.a,{onClick:function(e){return t.stopAllProcesses()},children:"Stop all"}),Object(se.jsx)(F.a,{onClick:function(e){return t.startAllProcesses()},children:"Start All"}),Object(se.jsx)(F.a,{onClick:function(e){return t.restartAllProcesses()},children:"Restart All"}),Object(se.jsx)(F.a,{onClick:function(e){return t.clearAllProcessLogs()},children:"Clear All"}),Object(se.jsx)(F.a,{onClick:function(e){o(null),j(!0)},children:"About"})]}),Object(se.jsx)(Q.a,{variant:"h5",sx:{flexGrow:1},children:"Supervisor"}),Object(se.jsx)(q.a,{title:"Reload Supervisor",children:Object(se.jsx)(C.a,{color:"inherit",onClick:function(e){return t.getAllProcessInfo()},children:Object(se.jsx)(z.a,{})})})]})}),Object(se.jsx)(ie,{supervisor:t,open:l,onClose:function(){return j(!1)}})]})},le=function(e){var t=e.process,r=e.supervisor,s=re.includes(t.state)?r.stopProcess:r.startProcess;return Object(se.jsx)(q.a,{title:t.name,children:Object(se.jsx)(C.a,{size:"small",onClick:function(e){e.stopPropagation(),s(t)},children:re.includes(t.state)?Object(se.jsx)(x.a,{sx:{color:"success.main"}}):t.state===n.FATAL?Object(se.jsx)(b.a,{sx:{color:"error.main"}}):Object(se.jsx)(b.a,{sx:{color:"warning.main"}})})})},je=function(e){var t=e.value,r=e.processes,n=e.supervisor,s=j.a.assign({RUNNING:0,STOPPED:0},j.a.countBy(r,(function(e){return re.includes(e.state)?"RUNNING":"STOPPED"})));return Object(se.jsx)(w.a,{sx:{"&.Mui-expanded":{minHeight:0},"& .MuiAccordionSummary-content":{margin:0},"& .MuiAccordionSummary-content.Mui-expanded":{margin:0}},children:Object(se.jsx)(V.a,{component:y.a,elevation:0,children:Object(se.jsx)(M.a,{size:"small",children:Object(se.jsx)(W.a,{children:Object(se.jsxs)(X.a,{children:[Object(se.jsx)(H.a,{width:200,children:t}),Object(se.jsx)(H.a,{width:120}),Object(se.jsx)(H.a,{align:"center",width:73,children:Object(se.jsxs)(h.a,{component:"span",sx:{color:s.RUNNING===r.length?"success.main":0===s.RUNNING?"error.main":"warning.main"},children:[s.RUNNING,"/",r.length]})}),Object(se.jsx)(H.a,{children:r.map((function(e){return Object(se.jsx)(le,{process:e,supervisor:n},e.name)}))}),Object(se.jsxs)(H.a,{padding:"none",width:132,children:[Object(se.jsx)(ae,{size:"small",title:"Stop Group",color:"primary",onClick:function(e){e.stopPropagation(),n.stopProcessGroup(t)},disabled:0===s.RUNNING,children:Object(se.jsx)(B.a,{fontSize:"small"})}),Object(se.jsx)(ae,{size:"small",title:"Start Group",color:"primary",onClick:function(e){e.stopPropagation(),n.startProcessGroup(t)},disabled:s.RUNNING===r.length,children:Object(se.jsx)(U.a,{fontSize:"small"})}),Object(se.jsx)(ae,{size:"small",title:"Restart Group",color:"primary",onClick:function(e){e.stopPropagation(),n.restartProcessGroup(t)},children:Object(se.jsx)(G.a,{fontSize:"small"})})]}),Object(se.jsx)(H.a,{width:113})]})})})})})},pe=function(e){var t=e.process;return Object(se.jsxs)(X.a,{children:[Object(se.jsx)(H.a,{width:120}),Object(se.jsx)(H.a,{width:200,children:t.name}),Object(se.jsx)(H.a,{padding:"none",align:"center",width:73,children:Object(se.jsx)(h.a,{component:"span",color:re.includes(t.state)?"success.main":t.state===n.FATAL?"error.main":"warning.main",children:t.statename})}),Object(se.jsx)(H.a,{children:t.description}),Object(se.jsxs)(H.a,{padding:"none",width:132,children:[Object(se.jsx)(h.a,{component:"span",children:Object(se.jsx)(K.a,{size:"small",checked:re.includes(t.state),onChange:function(r){return(re.includes(t.state)?e.supervisor.stopProcess:e.supervisor.startProcess)(t)}})}),Object(se.jsx)(ae,{size:"small",title:"Restart",color:"primary",onClick:function(r){return e.supervisor.restartProcess(t)},children:Object(se.jsx)(G.a,{fontSize:"small"})})]}),Object(se.jsxs)(H.a,{width:113,children:[Object(se.jsx)(S.a,{href:"logtail/".concat(t.group,":").concat(t.name),children:"stdout"}),"\xa0",Object(se.jsx)(S.a,{href:"logtail/".concat(t.group,":").concat(t.name,"/stderr"),children:"stderr"})]})]})},he=function(e){return Object(se.jsx)(A.a,{sx:{paddingTop:0,paddingBottom:0},children:Object(se.jsx)(V.a,{children:Object(se.jsx)(M.a,{size:"small",children:Object(se.jsx)(W.a,{children:e.processes.map((function(t){return Object(se.jsx)(pe,Object(i.a)({process:t},e),t.name)}))})})})})},de=function(e){return Object(se.jsxs)(N.a,{elevation:0,sx:{"&.Mui-expanded":{margin:0}},children:[Object(se.jsx)(je,Object(i.a)({},e)),Object(se.jsx)(he,Object(i.a)({},e))]})},xe=function(){var e=Object(s.useState)([]),t=Object(a.a)(e,2),r=t[0],n=t[1],c=new ne(n);return Object(s.useEffect)((function(){c.getAllProcessInfo()}),[]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(m.a,{}),Object(se.jsxs)(f.a,{fixed:!0,children:[Object(se.jsx)(ue,{supervisor:c}),j()(r).groupBy("group").toPairs().sortBy().map((function(e){var t=Object(a.a)(e,2),r=t[0],n=t[1];return Object(se.jsx)(de,{value:r,processes:j.a.sortBy(n,"name"),supervisor:c},r)})).value()]})]})},Oe=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,284)).then((function(t){var r=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,o=t.getTTFB;r(e),n(e),s(e),c(e),o(e)}))};o.a.render(Object(se.jsx)(s.StrictMode,{children:Object(se.jsx)(xe,{})}),document.getElementById("root")),Oe()}},[[196,1,2]]]);