import ujson
import requests
import pytest

from tests.api.base import get_api, get_headers

input_data = {
    "text": "Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>Digital Strategy, User Experience Digital Strategy, User Experience\n/nTThe Adobe Summit EMEA recognized Netcentric's achievements. News, Digital Strategy Thanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.  The Developers' Circle is a group of people who work together on projects. This year, we hope to see you at Adobe Summit EMEA. <p> Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>"
}

input_data2 = {
    "text": "Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing. The Developers' Circle is a group of people who work together on projects. \n/nTFind out more about what you can do to help shape the future. <p>Digital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience Netcentric's accomplishments were honored at the Adobe Summit EMEA. News, Digital Strategy\n/nTCustomers can now get a unified, real-time experience thanks to Adobe Experience Platform. Content Management, Digital Strategy The Developers' Circle is a group of people who work together on projects. Find out more about what you can do to help shape the future. This year, we hope to see you at Adobe Summit EMEA. <p>\n/nTDigital Strategy, User Experience With an Adobe Experience Platform SDK for Project Firefly, I'm contributing to Adobe's open source universe. Digital Strategy, User Experience The Adobe Summit EMEA recognized Netcentric's \n/nTachievements.\n/nTThanks to Adobe Experience Platform, customers may now get a unified, real-time experience. Digital Strategy, Content Management At the 2017 Adobe Symposium, we'll be shaping the future of digital marketing.\n/nTThe Developers' Circle is a group of people who work together on projects."
}


class TestParaphrasingMethods:
    def test_post_status_code_without_token(self):
        response = requests.post(get_api('paraphrasing'), ujson.dumps(input_data), timeout=300)
        assert response.status_code == 400

    def test_post_status_code_with_token_wrong_input(self):
        wrong_input_data = {
            "text": 1
        }
        response = requests.post(get_api('paraphrasing'), ujson.dumps(wrong_input_data), headers=get_headers(),
                                 timeout=600)
        res = ujson.loads(response.text)

        assert response.status_code == 400, "Invalid input data weren't handled"
        assert res["title"] == "Bad request"
        assert res["description"] == "Invalid input data"

    def test_post_status_code_with_token(self):
        response = requests.post(get_api('paraphrasing'), ujson.dumps(input_data), headers=get_headers(), timeout=600)
        res = ujson.loads(response.text)

        assert response.status_code == 201, "Bad request"
        assert type(res["paraphrased_text"]) is str and len(res["paraphrased_text"]) > 0, "There is no paraphrased text"
        assert type(res["paraphrased_text"]) is str and len(res["paraphrased_text"]) % len(
            input_data["text"]) >= len(input_data["text"]) * 0.7, "The paraphrased text's length less than should be"


class TestFreeParaphrasingMethods:
    def test_post_status_code_without_token(self):
        response = requests.post(get_api("free_paraphrasing"), ujson.dumps(input_data2), timeout=600)
        assert response.status_code == 400

    def test_post_status_code_with_token_wrong_input(self):
        wrong_input_data = {
            "text": 1
        }
        response = requests.post(get_api('free_paraphrasing'), ujson.dumps(wrong_input_data), headers=get_headers(),
                                 timeout=600)
        res = ujson.loads(response.text)

        assert response.status_code == 400, "Invalid input data weren't handled"
        assert res["title"] == "Bad request"
        assert res["description"] == "Invalid input data"

    def test_post_status_code_with_token(self):
        response = requests.post(get_api("free_paraphrasing"), ujson.dumps(input_data2), headers=get_headers(),
                                 timeout=1000)
        res = ujson.loads(response.text)

        assert response.status_code == 201, "Bad request"
        assert type(res["paraphrased_text"]) is str and len(res["paraphrased_text"]) > 0, "There is no paraphrased text"
        assert type(res["paraphrased_text"]) is str and len(res["paraphrased_text"]) % len(
            input_data2["text"]) >= len(input_data2["text"]) * 0.7, "The paraphrased text's length less than should be"
