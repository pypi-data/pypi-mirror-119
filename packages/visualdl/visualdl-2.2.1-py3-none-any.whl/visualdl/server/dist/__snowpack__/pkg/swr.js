import{r as p}from"./common/index-655cebff.js";import"./common/_commonjsHelpers-b3efd043.js";var ve=Object.prototype.hasOwnProperty;function ne(i,r){var e,a;if(i===r)return!0;if(i&&r&&(e=i.constructor)===r.constructor){if(e===Date)return i.getTime()===r.getTime();if(e===RegExp)return i.toString()===r.toString();if(e===Array){if((a=i.length)===r.length)for(;a--&&ne(i[a],r[a]););return a===-1}if(!e||typeof i=="object"){a=0;for(e in i)if(ve.call(i,e)&&++a&&!ve.call(r,e)||!(e in r)||!ne(i[e],r[e]))return!1;return Object.keys(r).length===a}}return i!==i&&r!==r}var te=new WeakMap,he=0;function Oe(i){if(!i.length)return"";for(var r="arg",e=0;e<i.length;++e){if(i[e]===null){r+="@null";continue}var a=void 0;typeof i[e]!="object"&&typeof i[e]!="function"?typeof i[e]=="string"?a='"'+i[e]+'"':a=String(i[e]):te.has(i[e])?a=te.get(i[e]):(a=he,te.set(i[e],he++)),r+="@"+a}return r}var Re=function(){function i(r){r===void 0&&(r={}),this.cache=new Map(Object.entries(r)),this.subs=[]}return i.prototype.get=function(r){var e=this.serializeKey(r)[0];return this.cache.get(e)},i.prototype.set=function(r,e){var a=this.serializeKey(r)[0];this.cache.set(a,e),this.notify()},i.prototype.keys=function(){return Array.from(this.cache.keys())},i.prototype.has=function(r){var e=this.serializeKey(r)[0];return this.cache.has(e)},i.prototype.clear=function(){this.cache.clear(),this.notify()},i.prototype.delete=function(r){var e=this.serializeKey(r)[0];this.cache.delete(e),this.notify()},i.prototype.serializeKey=function(r){var e=null;if(typeof r=="function")try{r=r()}catch(t){r=""}Array.isArray(r)?(e=r,r=Oe(r)):r=String(r||"");var a=r?"err@"+r:"",n=r?"validating@"+r:"";return[r,e,a,n]},i.prototype.subscribe=function(r){var e=this;if(typeof r!="function")throw new Error("Expected the listener to be a function.");var a=!0;return this.subs.push(r),function(){if(!!a){a=!1;var n=e.subs.indexOf(r);n>-1&&(e.subs[n]=e.subs[e.subs.length-1],e.subs.length--)}}},i.prototype.notify=function(){for(var r=0,e=this.subs;r<e.length;r++){var a=e[r];a()}},i}(),ie=!0,Ee=function(){return ie},Se=function(){return typeof document!="undefined"&&document.visibilityState!==void 0?document.visibilityState!=="hidden":!0},Ce=function(i){return fetch(i).then(function(r){return r.json()})},Te=function(i){typeof window!="undefined"&&window.addEventListener!==void 0&&typeof document!="undefined"&&document.addEventListener!==void 0&&(document.addEventListener("visibilitychange",function(){return i()},!1),window.addEventListener("focus",function(){return i()},!1))},xe=function(i){typeof window!="undefined"&&window.addEventListener!==void 0&&(window.addEventListener("online",function(){ie=!0,i()},!1),window.addEventListener("offline",function(){return ie=!1},!1))},Ve={isOnline:Ee,isDocumentVisible:Se,fetcher:Ce,registerOnFocus:Te,registerOnReconnect:xe},ue=function(){return ue=Object.assign||function(i){for(var r,e=1,a=arguments.length;e<a;e++){r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i[n]=r[n])}return i},ue.apply(this,arguments)},v=new Re;function De(i,r,e,a,n){if(!!e.isDocumentVisible()&&!(typeof e.errorRetryCount=="number"&&n.retryCount>e.errorRetryCount)){var t=Math.min(n.retryCount,8),c=~~((Math.random()+.5)*(1<<t))*e.errorRetryInterval;setTimeout(a,c,n)}}var ye=typeof window!="undefined"&&navigator.connection&&["slow-2g","2g"].indexOf(navigator.connection.effectiveType)!==-1,I=ue({onLoadingSlow:function(){},onSuccess:function(){},onError:function(){},onErrorRetry:De,errorRetryInterval:(ye?10:5)*1e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:(ye?5:3)*1e3,refreshInterval:0,revalidateOnFocus:!0,revalidateOnReconnect:!0,refreshWhenHidden:!1,refreshWhenOffline:!1,shouldRetryOnError:!0,suspense:!1,compare:ne,isPaused:function(){return!1}},Ve),$=typeof window=="undefined"||!!(typeof Deno!="undefined"&&Deno&&Deno.version&&Deno.version.deno),Ie=$?null:window.requestAnimationFrame?function(i){return window.requestAnimationFrame(i)}:function(i){return setTimeout(i,1)},ae=$?p.useEffect:p.useLayoutEffect,B=p.createContext({});B.displayName="SWRConfigContext";var fe=function(i,r,e,a){function n(t){return t instanceof e?t:new e(function(c){c(t)})}return new(e||(e=Promise))(function(t,c){function f(o){try{u(a.next(o))}catch(l){c(l)}}function h(o){try{u(a.throw(o))}catch(l){c(l)}}function u(o){o.done?t(o.value):n(o.value).then(f,h)}u((a=a.apply(i,r||[])).next())})},oe=function(i,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,n,t,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(u){return function(o){return h([u,o])}}function h(u){if(a)throw new TypeError("Generator is already executing.");for(;e;)try{if(a=1,n&&(t=u[0]&2?n.return:u[0]?n.throw||((t=n.return)&&t.call(n),0):n.next)&&!(t=t.call(n,u[1])).done)return t;switch(n=0,t&&(u=[u[0]&2,t.value]),u[0]){case 0:case 1:t=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,n=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!t||u[1]>t[0]&&u[1]<t[3])){e.label=u[1];break}if(u[0]===6&&e.label<t[1]){e.label=t[1],t=u;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(u);break}t[2]&&e.ops.pop(),e.trys.pop();continue}u=r.call(i,e)}catch(o){u=[6,o],n=0}finally{a=t=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},b={},M={},ge={},pe={},J={},N={},Q={},se=function(){var i=0;return function(){return++i}}();if(!$){var me=function(i){if(!(!I.isDocumentVisible()||!I.isOnline()))for(var r in i)i[r][0]&&i[r][0]()};typeof I.registerOnFocus=="function"&&I.registerOnFocus(function(){return me(ge)}),typeof I.registerOnReconnect=="function"&&I.registerOnReconnect(function(){return me(pe)})}var Ae=function(i,r){r===void 0&&(r=!0);var e=v.serializeKey(i),a=e[0],n=e[2],t=e[3];if(!a)return Promise.resolve();var c=J[a];if(a&&c){for(var f=v.get(a),h=v.get(n),u=v.get(t),o=[],l=0;l<c.length;++l)o.push(c[l](r,f,h,u,l>0));return Promise.all(o).then(function(){return v.get(a)})}return Promise.resolve(v.get(a))},ce=function(i,r,e,a){var n=J[i];if(i&&n)for(var t=0;t<n.length;++t)n[t](!1,r,e,a)},je=function(i,r,e){return e===void 0&&(e=!0),fe(void 0,void 0,void 0,function(){var a,n,t,c,f,h,u,o,l,P,A,k,E;return oe(this,function(w){switch(w.label){case 0:if(a=v.serializeKey(i),n=a[0],t=a[2],!n)return[2];if(typeof r=="undefined")return[2,Ae(i,e)];if(N[n]=se()-1,Q[n]=0,c=N[n],f=M[n],o=!1,r&&typeof r=="function")try{r=r(v.get(n))}catch(X){r=void 0,u=X}if(!(r&&typeof r.then=="function"))return[3,5];o=!0,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,r];case 2:return h=w.sent(),[3,4];case 3:return l=w.sent(),u=l,[3,4];case 4:return[3,6];case 5:h=r,w.label=6;case 6:if(P=function(){if(c!==N[n]||f!==M[n]){if(u)throw u;return!0}},P())return[2,h];if(typeof h!="undefined"&&v.set(n,h),v.set(t,u),Q[n]=se()-1,!o&&P())return[2,h];if(A=J[n],A){for(k=[],E=0;E<A.length;++E)k.push(A[E](!!e,h,u,void 0,E>0));return[2,Promise.all(k).then(function(){if(u)throw u;return v.get(n)})]}if(u)throw u;return[2,h]}})})};function _e(){for(var i=this,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var a=r[0],n=Object.assign({},I,p.useContext(B),r.length>2?r[2]:r.length===2&&typeof r[1]=="object"?r[1]:{}),t=r.length>2||r.length===2&&typeof r[1]=="function"||r[1]===null?r[1]:n.fetcher,c=v.serializeKey(a),f=c[0],h=c[1],u=c[2],o=c[3],l=p.useRef(n);ae(function(){l.current=n});var P=function(){return n.revalidateOnMount||!n.initialData&&n.revalidateOnMount===void 0},A=function(){var s=v.get(f);return typeof s=="undefined"?n.initialData:s},k=function(){return!!v.get(o)||f&&P()},E=A(),w=v.get(u),X=k(),U=p.useRef({data:!1,error:!1,isValidating:!1}),m=p.useRef({data:E,error:w,isValidating:X});p.useDebugValue(m.current.data);var be=p.useState({})[1],T=p.useCallback(function(s){var y=!1;for(var d in s)m.current[d]!==s[d]&&(m.current[d]=s[d],U.current[d]&&(y=!0));if(y){if(F.current||!z.current)return;be({})}},[]),F=p.useRef(!1),K=p.useRef(f),z=p.useRef(!1),H=p.useCallback(function(s){for(var y,d=[],g=1;g<arguments.length;g++)d[g-1]=arguments[g];F.current||!z.current||f===K.current&&(y=l.current)[s].apply(y,d)},[f]),le=p.useCallback(function(s,y){return je(K.current,s,y)},[]),Y=function(s,y){return s[f]?s[f].push(y):s[f]=[y],function(){var d=s[f],g=d.indexOf(y);g>=0&&(d[g]=d[d.length-1],d.pop())}},S=p.useCallback(function(s){return s===void 0&&(s={}),fe(i,void 0,void 0,function(){var y,d,g,L,W,j,O,D,_,C;return oe(this,function(R){switch(R.label){case 0:if(!f||!t)return[2,!1];if(F.current)return[2,!1];if(l.current.isPaused())return[2,!1];y=s.retryCount,d=y===void 0?0:y,g=s.dedupe,L=g===void 0?!1:g,W=!0,j=typeof b[f]!="undefined"&&L,R.label=1;case 1:return R.trys.push([1,6,,7]),T({isValidating:!0}),v.set(o,!0),j||ce(f,m.current.data,m.current.error,!0),O=void 0,D=void 0,j?(D=M[f],[4,b[f]]):[3,3];case 2:return O=R.sent(),[3,5];case 3:return n.loadingTimeout&&!v.get(f)&&setTimeout(function(){W&&H("onLoadingSlow",f,n)},n.loadingTimeout),h!==null?b[f]=t.apply(void 0,h):b[f]=t(f),M[f]=D=se(),[4,b[f]];case 4:O=R.sent(),setTimeout(function(){delete b[f],delete M[f]},n.dedupingInterval),H("onSuccess",O,f,n),R.label=5;case 5:return M[f]>D?[2,!1]:N[f]&&(D<=N[f]||D<=Q[f]||Q[f]===0)?(T({isValidating:!1}),[2,!1]):(v.set(u,void 0),v.set(o,!1),_={isValidating:!1},typeof m.current.error!="undefined"&&(_.error=void 0),n.compare(m.current.data,O)||(_.data=O),n.compare(v.get(f),O)||v.set(f,O),T(_),j||ce(f,O,_.error,!1),[3,7]);case 6:return C=R.sent(),delete b[f],delete M[f],l.current.isPaused()?(T({isValidating:!1}),[2,!1]):(v.set(u,C),m.current.error!==C&&(T({isValidating:!1,error:C}),j||ce(f,void 0,C,!1)),H("onError",C,f,n),n.shouldRetryOnError&&H("onErrorRetry",C,f,n,S,{retryCount:d+1,dedupe:!0}),[3,7]);case 7:return W=!1,[2,!0]}})})},[f]);ae(function(){if(!!f){F.current=!1;var s=z.current;z.current=!0;var y=m.current.data,d=A();K.current=f,n.compare(y,d)||T({data:d});var g=function(){return S({dedupe:!0})};(s||P())&&(typeof d!="undefined"&&!$?Ie(g):g());var L=!1,W=function(){L||!l.current.revalidateOnFocus||(L=!0,g(),setTimeout(function(){return L=!1},l.current.focusThrottleInterval))},j=function(){l.current.revalidateOnReconnect&&g()},O=function(R,Z,de,ee,re){R===void 0&&(R=!0),re===void 0&&(re=!0);var q={},G=!1;return typeof Z!="undefined"&&!n.compare(m.current.data,Z)&&(q.data=Z,G=!0),m.current.error!==de&&(q.error=de,G=!0),typeof ee!="undefined"&&m.current.isValidating!==ee&&(q.isValidating=ee,G=!0),G&&T(q),R?re?g():S():!1},D=Y(ge,W),_=Y(pe,j),C=Y(J,O);return function(){T=function(){return null},F.current=!0,D(),_(),C()}}},[f,S]),ae(function(){var s=null,y=function(){return fe(i,void 0,void 0,function(){return oe(this,function(d){switch(d.label){case 0:return!m.current.error&&(l.current.refreshWhenHidden||l.current.isDocumentVisible())&&(l.current.refreshWhenOffline||l.current.isOnline())?[4,S({dedupe:!0})]:[3,2];case 1:d.sent(),d.label=2;case 2:return l.current.refreshInterval&&s&&(s=setTimeout(y,l.current.refreshInterval)),[2]}})})};return l.current.refreshInterval&&(s=setTimeout(y,l.current.refreshInterval)),function(){s&&(clearTimeout(s),s=null)}},[n.refreshInterval,n.refreshWhenHidden,n.refreshWhenOffline,S]);var x,V;if(n.suspense){if(x=v.get(f),V=v.get(u),typeof x=="undefined"&&(x=E),typeof V=="undefined"&&(V=w),typeof x=="undefined"&&typeof V=="undefined"){if(b[f]||S(),b[f]&&typeof b[f].then=="function")throw b[f];x=b[f]}if(typeof x=="undefined"&&V)throw V}var we=p.useMemo(function(){var s={revalidate:S,mutate:le};return Object.defineProperties(s,{error:{get:function(){return U.current.error=!0,n.suspense?V:K.current===f?m.current.error:w},enumerable:!0},data:{get:function(){return U.current.data=!0,n.suspense?x:K.current===f?m.current.data:E},enumerable:!0},isValidating:{get:function(){return U.current.isValidating=!0,f?m.current.isValidating:!1},enumerable:!0}}),s},[S,E,w,le,f,n.suspense,V,x]);return we}Object.defineProperty(B.Provider,"default",{value:I});var Me=B.Provider,ke=function(i,r,e,a){function n(t){return t instanceof e?t:new e(function(c){c(t)})}return new(e||(e=Promise))(function(t,c){function f(o){try{u(a.next(o))}catch(l){c(l)}}function h(o){try{u(a.throw(o))}catch(l){c(l)}}function u(o){o.done?t(o.value):n(o.value).then(f,h)}u((a=a.apply(i,r||[])).next())})},Fe=function(i,r){var e={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},a,n,t,c;return c={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function f(u){return function(o){return h([u,o])}}function h(u){if(a)throw new TypeError("Generator is already executing.");for(;e;)try{if(a=1,n&&(t=u[0]&2?n.return:u[0]?n.throw||((t=n.return)&&t.call(n),0):n.next)&&!(t=t.call(n,u[1])).done)return t;switch(n=0,t&&(u=[u[0]&2,t.value]),u[0]){case 0:case 1:t=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,n=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(t=e.trys,!(t=t.length>0&&t[t.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!t||u[1]>t[0]&&u[1]<t[3])){e.label=u[1];break}if(u[0]===6&&e.label<t[1]){e.label=t[1],t=u;break}if(t&&e.label<t[2]){e.label=t[2],e.ops.push(u);break}t[2]&&e.ops.pop(),e.trys.pop();continue}u=r.call(i,e)}catch(o){u=[6,o],n=0}finally{a=t=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Ke=function(i,r){var e={};for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&r.indexOf(a)<0&&(e[a]=i[a]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(i);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(i,a[n])&&(e[a[n]]=i[a[n]]);return e};export default _e;export{Me as SWRConfig,v as cache};
