import{r as o}from"./common/index-655cebff.js";import"./common/index-55e7d60e.js";import"./common/hoist-non-react-statics.cjs-28ce0fec.js";import{r as E}from"./common/index-6f69db2e.js";import"./common/_commonjsHelpers-b3efd043.js";var a=o.createContext(null);function N(e){e()}var x=N,j=function(t){return x=t},W=function(){return x},C={notify:function(){}};function B(){var e=W(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var n=t;n;)n.callback(),n=n.next})},get:function(){for(var n=[],c=t;c;)n.push(c),c=c.next;return n},subscribe:function(n){var c=!0,u=r={callback:n,next:null,prev:r};return u.prev?u.prev.next=u:t=u,function(){!c||t===null||(c=!1,u.next?u.next.prev=u.prev:r=u.prev,u.prev?u.prev.next=u.next:t=u.next)}}}}var g=function(){function e(r,s){this.store=r,this.parentSub=s,this.unsubscribe=null,this.listeners=C,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(s){return this.trySubscribe(),this.listeners.subscribe(s)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=B())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=C)},e}(),p=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined"?o.useLayoutEffect:o.useEffect;function U(e){var t=e.store,r=e.context,s=e.children,n=o.useMemo(function(){var i=new g(t);return i.onStateChange=i.notifyNestedSubs,{store:t,subscription:i}},[t]),c=o.useMemo(function(){return t.getState()},[t]);p(function(){var i=n.subscription;return i.trySubscribe(),c!==t.getState()&&i.notifyNestedSubs(),function(){i.tryUnsubscribe(),i.onStateChange=null}},[n,c]);var u=r||a;return o.createElement(u.Provider,{value:n},s)}function R(){var e=o.useContext(a);return e}function w(e){e===void 0&&(e=a);var t=e===a?R:function(){return o.useContext(e)};return function(){var s=t(),n=s.store;return n}}var D=w();function H(e){e===void 0&&(e=a);var t=e===a?D:w(e);return function(){var s=t();return s.dispatch}}var L=H(),M=function(t,r){return t===r};function V(e,t,r,s){var n=o.useReducer(function(b){return b+1},0),c=n[1],u=o.useMemo(function(){return new g(r,s)},[r,s]),i=o.useRef(),l=o.useRef(),d=o.useRef(),f=o.useRef(),v=r.getState(),h;try{if(e!==l.current||v!==d.current||i.current){var S=e(v);f.current===void 0||!t(S,f.current)?h=S:h=f.current}else h=f.current}catch(b){throw i.current&&(b.message+=`
The error may be correlated with this previous error:
`+i.current.stack+`

`),b}return p(function(){l.current=e,d.current=v,f.current=h,i.current=void 0}),p(function(){function b(){try{var m=r.getState(),y=l.current(m);if(t(y,f.current))return;f.current=y,d.current=m}catch(k){i.current=k}c()}return u.onStateChange=b,u.trySubscribe(),b(),function(){return u.tryUnsubscribe()}},[r,u]),h}function _(e){e===void 0&&(e=a);var t=e===a?R:function(){return o.useContext(e)};return function(s,n){n===void 0&&(n=M);var c=t(),u=c.store,i=c.subscription,l=V(s,n,u,i);return o.useDebugValue(l),l}}var $=_();j(E.unstable_batchedUpdates);export{U as Provider,L as useDispatch,$ as useSelector};
