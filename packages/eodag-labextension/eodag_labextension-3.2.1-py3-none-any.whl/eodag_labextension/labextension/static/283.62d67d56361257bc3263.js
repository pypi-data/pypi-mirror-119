(self.webpackChunkeodag_labextension=self.webpackChunkeodag_labextension||[]).push([[283],{2283:(e,r,t)=>{"use strict";t.r(r),t.d(r,{Controller:()=>D,FormProvider:()=>j,appendErrors:()=>E,get:()=>d,set:()=>$,useController:()=>C,useFieldArray:()=>te,useForm:()=>Fe,useFormContext:()=>A,useFormState:()=>w,useWatch:()=>_e});var n=t(6271),s=e=>"checkbox"===e.type,c=e=>null==e;const u=e=>"object"==typeof e;var a=e=>!c(e)&&!Array.isArray(e)&&u(e)&&!(e instanceof Date),i=e=>e.substring(0,e.search(/.\d/))||e,l=(e,r)=>[...e].some((e=>i(r)===e)),o=e=>e.filter(Boolean),f=e=>void 0===e,d=(e={},r,t)=>{const n=o(r.split(/[,[\].]+?/)).reduce(((e,r)=>c(e)?e:e[r]),e);return f(n)||n===e?f(e[r])?t:e[r]:n};const b="blur",g="onChange",m="onSubmit",y="all",h="undefined",v="pattern",x="required";var p=(e,r)=>{const t=Object.assign({},e);return delete t[r],t};const O=n.createContext(null);O.displayName="RHFContext";const A=()=>n.useContext(O),j=e=>n.createElement(O.Provider,{value:p(e,"children")},e.children);var V=(e,r,t,n,s=!0)=>e?new Proxy(r,{get:(e,r)=>{if(r in e)return t.current[r]!==y&&(t.current[r]=!s||y),n&&(n.current[r]=!0),e[r]}}):r,k=e=>a(e)&&!Object.keys(e).length,R=(e,r,t)=>{const n=p(e,"name");return k(n)||Object.keys(n).length>=Object.keys(r).length||Object.keys(n).find((e=>r[e]===(!t||y)))},F=e=>Array.isArray(e)?e:[e],_=typeof window!==h&&typeof window.HTMLElement!==h&&typeof document!==h;const S=_?"Proxy"in window:typeof Proxy!==h;function w(e){const{control:r,name:t}=e||{},s=A(),{formStateRef:c,formStateSubjectRef:u,readFormStateRef:a}=r||s.control,i=n.useRef(t);i.current=t;const[l,o]=n.useState(c.current),f=n.useRef({isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1});return n.useEffect((()=>{const e=u.current.subscribe({next:e=>(!i.current||!e.name||F(i.current).includes(e.name))&&R(e,f.current)&&o(Object.assign(Object.assign({},c.current),e))});return()=>e.unsubscribe()}),[]),V(S,l,a,f,!1)}function C({name:e,rules:r,defaultValue:t,control:c,shouldUnregister:u}){const i=A(),{defaultValuesRef:o,register:g,fieldsRef:m,unregister:y,fieldArrayNamesRef:h,controllerSubjectRef:v,shouldUnmount:x,inFieldArrayActionRef:p}=c||i.control,{onChange:O,onBlur:j,ref:V}=g(e,r),k=l(h.current,e),[R,F]=n.useState(f(d(m.current,e)._f.value)||k?f(t)?d(o.current,e):t:d(m.current,e)._f.value),_=w({control:c||i.control,name:e});return d(m.current,e)._f.value=R,n.useEffect((()=>{const r=v.current.subscribe({next:r=>(!r.name||e===r.name)&&F(d(r.values,e))});return()=>{r.unsubscribe();const t=x||u;(k?t&&!p.current:t)?y(e):d(m.current,e)&&(d(m.current,e)._f.mount=!1)}}),[e]),{field:{onChange:r=>{const t=(e=>a(e)&&e.target?s(e.target)?e.target.checked:e.target.value:e)(r);F(t),O({target:{value:t,name:e},type:"change"})},onBlur:()=>{j({target:{name:e},type:b})},name:e,value:R,ref:e=>e&&V(e)},formState:_,fieldState:Object.defineProperties({},{invalid:{get:()=>!!d(_.errors,e)},isDirty:{get:()=>!!d(_.dirtyFields,e)},isTouched:{get:()=>!!d(_.touchedFields,e)},error:{get:()=>d(_.errors,e)}})}}const D=e=>e.render(C(e));var E=(e,r,t,n,s)=>r?Object.assign(Object.assign({},t[e]),{types:Object.assign(Object.assign({},t[e]&&t[e].types?t[e].types:{}),{[n]:s||!0})}):{},B=e=>/^\w*$/.test(e),N=e=>o(e.replace(/["|']|\]/g,"").split(/\.|\[/));function $(e,r,t){let n=-1;const s=B(r)?[r]:N(r),c=s.length,u=c-1;for(;++n<c;){const r=s[n];let c=t;if(n!==u){const t=e[r];c=a(t)||Array.isArray(t)?t:isNaN(+s[n+1])?{}:[]}e[r]=c,e=e[r]}return e}const I=(e,r,t)=>{for(const n of t||Object.keys(e)){const t=d(e,n);if(t){const e=t._f,n=p(t,"_f");if(e&&r(e.name)){if(e.ref.focus&&f(e.ref.focus()))break;if(e.refs){e.refs[0].focus();break}}else a(n)&&I(n,r)}}},M=(e,r,t={})=>{for(const n in e.current){const s=e.current[n];if(s&&!c(t)){const e=s._f,c=p(s,"_f");$(t,n,e&&e.ref?e.ref.disabled||e.refs&&e.refs.every((e=>e.disabled))?void 0:e.value:Array.isArray(s)?[]:{}),c&&M({current:c},r,t[n])}}return t};var T=()=>{const e=typeof performance===h?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(r=>{const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)}))},W=(e=[],r)=>e.map((e=>Object.assign({[r]:e&&e[r]||T()},e))),L=e=>c(e)||!u(e);function P(e,r,t){if(L(e)||L(r)||e instanceof Date||r instanceof Date)return e===r;if(!n.isValidElement(e)){const n=Object.keys(e),s=Object.keys(r);if(n.length!==s.length)return!1;for(const s of n){const n=e[s];if(!t||"ref"!==s){const e=r[s];if((a(n)||Array.isArray(n))&&(a(e)||Array.isArray(e))?!P(n,e,t):n!==e)return!1}}}return!0}function U(e,r){if(L(e)||L(r))return r;for(const t in r){const n=e[t],s=r[t];try{e[t]=a(n)&&a(s)||Array.isArray(n)&&Array.isArray(s)?U(n,s):s}catch(e){}}return e}function q(e,r,t,n,s){let c=-1;for(;++c<e.length;){for(const n in e[c])Array.isArray(e[c][n])?(!t[c]&&(t[c]={}),t[c][n]=[],q(e[c][n],d(r[c]||{},n,[]),t[c][n],t[c],n)):P(d(r[c]||{},n),e[c][n])?$(t[c]||{},n):t[c]=Object.assign(Object.assign({},t[c]),{[n]:!0});n&&!t.length&&delete n[s]}return t}var H=(e,r,t)=>U(q(e,r,t.slice(0,e.length)),q(r,e,t.slice(0,e.length)));function z(e,r){return[...e,...F(r)]}var G=e=>Array.isArray(e)?Array(e.length).fill(void 0):void 0;function J(e,r,t){return[...e.slice(0,r),...F(t),...e.slice(r)]}var K=e=>"string"==typeof e,Q=(e,r,t)=>Array.isArray(e)?(f(e[t])&&(e[t]=void 0),e.splice(t,0,e.splice(r,1)[0]),e):[];function X(e,r){return[...F(r),...e]}var Y=(e,r)=>f(r)?[]:function(e,r){let t=0;const n=[...e];for(const e of r)n.splice(e-t,1),t++;return o(n).length?n:[]}(e,F(r).sort(((e,r)=>e-r))),Z=(e,r,t)=>{e[r]=[e[t],e[t]=e[r]][0]},ee=e=>"boolean"==typeof e;function re(e,r){const t=B(r)?[r]:N(r),n=1==t.length?e:function(e,r){const t=r.slice(0,-1).length;let n=0;for(;n<t;)e=f(e)?n++:e[r[n++]];return e}(e,t),s=t[t.length-1];let c;n&&delete n[s];for(let r=0;r<t.slice(0,-1).length;r++){let n,s=-1;const u=t.slice(0,-(r+1)),i=u.length-1;for(r>0&&(c=e);++s<u.length;){const r=u[s];n=n?n[r]:e[r],i===s&&(a(n)&&k(n)||Array.isArray(n)&&!n.filter((e=>a(e)&&!k(e)||ee(e))).length)&&(c?delete c[r]:delete e[r]),c=n}}return e}const te=({control:e,name:r,keyName:t="id",shouldUnregister:s})=>{const c=A(),u=n.useRef(""),{isWatchAllRef:a,watchFieldsRef:l,getIsDirty:b,watchSubjectRef:g,fieldArraySubjectRef:m,fieldArrayNamesRef:y,fieldsRef:h,defaultValuesRef:v,formStateRef:x,formStateSubjectRef:O,readFormStateRef:j,validFieldsRef:V,fieldsWithValidationRef:k,fieldArrayDefaultValuesRef:R,unregister:_,shouldUnmount:S,inFieldArrayActionRef:w}=e||c.control,[C,D]=n.useState(W(d(h.current,r)?d(M(h),r):d(R.current,i(r))?d(R.current,r,[]):d(v.current,r,[]),t));$(R.current,r,[...C]),y.current.add(r);const E=e=>e.map((e=>p(e||{},t))),B=()=>{const e=d(M(h),r,[]);return W(d(R.current,r,[]).map(((r,t)=>Object.assign(Object.assign({},r),e[t]))),t)},N=(e,t)=>t?f(t.focusIndex)?t.focusName?t.focusName:t.shouldFocus?`${r}.${e}`:"":`${r}.${t.focusIndex}`:`${r}.${e}`,T=(e=[])=>D(W(e,t)),P=e=>!o(d(e,r,[])).length&&re(e,r),U=(e,t,n=[],s=!0)=>{if(w.current=!0,d(h.current,r)){const n=e(d(h.current,r),t.argA,t.argB);s&&$(h.current,r,n)}if(Array.isArray(d(x.current.errors,r))){const n=e(d(x.current.errors,r),t.argA,t.argB);s&&$(x.current.errors,r,n),P(x.current.errors)}if(j.current.touchedFields&&d(x.current.touchedFields,r)){const n=e(d(x.current.touchedFields,r),t.argA,t.argB);s&&$(x.current.touchedFields,r,n),P(x.current.touchedFields)}(j.current.dirtyFields||j.current.isDirty)&&($(x.current.dirtyFields,r,H(E(n),d(v.current,r,[]),d(x.current.dirtyFields,r,[]))),(e=>{e&&$(x.current.dirtyFields,r,H(E(e),d(v.current,r,[]),d(x.current.dirtyFields,r,[])))})(n),P(x.current.dirtyFields)),j.current.isValid&&($(V.current,r,e(d(V.current,r,[]),t.argA)),P(V.current),$(k.current,r,e(d(k.current,r,[]),t.argA)),P(k.current)),O.current.next({isDirty:b(r,E(n)),errors:x.current.errors,isValid:x.current.isValid})},q=(e,t=0,n="")=>e.forEach(((e,s)=>!L(e)&&Object.entries(e).forEach((([e,c])=>{const u=`${n||r}.${n?s:t+s}.${e}`;Array.isArray(c)?q(c,s,u):$(h.current,u,{_f:{ref:{name:u},name:u,value:L(c)?c:Object.assign({},c)}})}))));return n.useEffect((()=>{if(w.current=!1,a.current)O.current.next({});else for(const e of l.current)if(r.startsWith(e)){O.current.next({});break}g.current.next({name:r,formValues:M(h)}),u.current&&I(h.current,(e=>K(e)&&e.startsWith(u.current))),u.current="",m.current.next({name:r,fields:E([...C])})}),[C,r]),n.useEffect((()=>{const e=m.current.subscribe({next({name:e,fields:t,isReset:n}){n&&(re(h.current,e||r),e?$(R.current,e,t):R.current=t,T(d(R.current,r)))}});return!d(h.current,r)&&$(h.current,r,[]),()=>{e.unsubscribe(),(S||s)&&_(r)}}),[]),{swap:n.useCallback(((e,r)=>{const t=B();Z(t,e,r),U(Z,{argA:e,argB:r},t,!1),T(t)}),[r]),move:n.useCallback(((e,r)=>{const t=B();Q(t,e,r),T(t),U(Q,{argA:e,argB:r},t,!1)}),[r]),prepend:n.useCallback(((e,r)=>{const t=F(e),n=X(B(),t);T(n),U(X,{argA:G(e)},n),q(t),u.current=N(0,r)}),[r]),append:n.useCallback(((e,r)=>{const t=F(e),n=z(B(),t),s=n.length-t.length;T(n),U(z,{argA:G(e)},n,!1),q(t,s),u.current=N(s,r)}),[r]),remove:n.useCallback((e=>{const t=Y(B(),e);(e=>{F(e).forEach((e=>$(h.current,`${r}${f(e)?"":`.${e}`}`,f(e)?[]:void 0)))})(e),T(t),U(Y,{argA:e},t)}),[r]),insert:n.useCallback(((e,r,t)=>{const n=F(r),s=J(B(),e,n);T(s),U(J,{argA:e,argB:G(r)},s),q(n,e),u.current=N(e,t)}),[r]),fields:C}};function ne(e,r){const t={};for(const n of e){const e=d(r,n);e&&(B(n)?t[n]=e._f:$(t,n,e._f))}return t}var se=e=>"file"===e.type,ce=e=>"select-multiple"===e.type,ue=e=>"radio"===e.type;const ae={value:!1,isValid:!1},ie={value:!0,isValid:!0};var le=e=>{if(Array.isArray(e)){if(e.length>1){const r=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:r,isValid:!!r.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!f(e[0].attributes.value)?f(e[0].value)||""===e[0].value?ie:{value:e[0].value,isValid:!0}:ie:ae}return ae},oe=(e,{valueAsNumber:r,valueAsDate:t,setValueAs:n})=>r?""===e?NaN:+e:t?new Date(e):n?n(e):e;const fe={isValid:!1,value:null};var de=e=>Array.isArray(e)?e.reduce(((e,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:e),fe):fe;function be(e){if(e&&e._f){const t=e._f.ref;if(t.disabled)return;return se(t)?t.files:ue(t)?de(e._f.refs).value:ce(t)?(r=t.options,[...r].filter((({selected:e})=>e)).map((({value:e})=>e))):s(t)?le(e._f.refs).value:oe(f(t.value)?e._f.ref.value:t.value,e._f)}var r}var ge=(e,r)=>e&&r&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),me=e=>"function"==typeof e,ye=e=>K(e)||n.isValidElement(e),he=e=>e instanceof RegExp;function ve(e,r,t="validate"){if(ye(e)||Array.isArray(e)&&e.every(ye)||ee(e)&&!e)return{type:t,message:ye(e)?e:"",ref:r}}var xe=e=>a(e)&&!he(e)?e:{value:e,message:""},pe=async({_f:{ref:e,refs:r,required:t,maxLength:n,minLength:u,min:i,max:l,pattern:o,validate:f,name:d,value:b,valueAsNumber:g,mount:m}},y)=>{if(!m)return{};const h={},p=ue(e),O=s(e),A=p||O,j=(g||se(e))&&!e.value||""===b||Array.isArray(b)&&!b.length,V=E.bind(null,d,y,h),R=(r,t,n,s="maxLength",c="minLength")=>{const u=r?t:n;h[d]=Object.assign({type:r?s:c,message:u,ref:e},V(r?s:c,u))};if(t&&(!p&&!O&&(j||c(b))||ee(b)&&!b||O&&!le(r).isValid||p&&!de(r).isValid)){const{value:n,message:s}=ye(t)?{value:!!t,message:t}:xe(t);if(n&&(h[d]=Object.assign({type:x,message:s,ref:A?(r||[])[0]||{}:e},V(x,s)),!y))return h}if(!(c(i)&&c(l)||""===b)){let r,t;const n=xe(l),s=xe(i);if(isNaN(b)){const c=e.valueAsDate||new Date(b);K(n.value)&&(r=c>new Date(n.value)),K(s.value)&&(t=c<new Date(s.value))}else{const u=e.valueAsNumber||parseFloat(b);c(n.value)||(r=u>n.value),c(s.value)||(t=u<s.value)}if((r||t)&&(R(!!r,n.message,s.message,"max","min"),!y))return h}if(K(b)&&!j&&(n||u)){const e=xe(n),r=xe(u),t=!c(e.value)&&b.length>e.value,s=!c(r.value)&&b.length<r.value;if((t||s)&&(R(t,e.message,r.message),!y))return h}if(K(b)&&o&&!j){const{value:r,message:t}=xe(o);if(he(r)&&!b.match(r)&&(h[d]=Object.assign({type:v,message:t,ref:e},V(v,t)),!y))return h}if(f){const t=A&&r?r[0]:e;if(me(f)){const e=ve(await f(b),t);if(e&&(h[d]=Object.assign(Object.assign({},e),V("validate",e.message)),!y))return h}else if(a(f)){let e={};for(const[r,n]of Object.entries(f)){if(!k(e)&&!y)break;const s=ve(await n(b),t,r);s&&(e=Object.assign(Object.assign({},s),V(r,s.message)),y&&(h[d]=e))}if(!k(e)&&(h[d]=Object.assign({ref:t},e),!y))return h}}return h},Oe=e=>({isOnSubmit:!e||e===m,isOnBlur:"onBlur"===e,isOnChange:e===g,isOnAll:e===y,isOnTouch:"onTouched"===e}),Ae=e=>e instanceof HTMLElement;class je{constructor(){this.tearDowns=[]}add(e){this.tearDowns.push(e)}unsubscribe(){for(const e of this.tearDowns)e();this.tearDowns=[]}}class Ve{constructor(e,r){this.observer=e,this.closed=!1,r.add((()=>this.closed=!0))}next(e){this.closed||this.observer.next(e)}}class ke{constructor(){this.observers=[]}next(e){for(const r of this.observers)r.next(e)}subscribe(e){const r=new je,t=new Ve(e,r);return this.observers.push(t),r}unsubscribe(){this.observers=[]}}const Re=typeof window===h;function Fe({mode:e="onSubmit",reValidateMode:r="onChange",resolver:t,context:u,defaultValues:g={},shouldFocusError:m=!0,shouldUnregister:h,criteriaMode:v}={}){const x=n.useRef({}),O=n.useRef(new Set),A=n.useRef(new ke),j=n.useRef(new Set),w=n.useRef(new ke),C=n.useRef(new ke),D=n.useRef(new ke),E=n.useRef({}),B=n.useRef(!1),N=n.useRef(new Set),T=n.useRef(!1),W=n.useRef({}),U=n.useRef({}),q=n.useRef(g),z=n.useRef(!1),G=n.useRef(u),J=n.useRef(t),Q=n.useRef(new Set),X=Oe(e),Y=v===y,[Z,ee]=n.useState({isDirty:!1,isValidating:!1,dirtyFields:{},isSubmitted:!1,submitCount:0,touchedFields:{},isSubmitting:!1,isSubmitSuccessful:!1,isValid:!X.isOnSubmit,errors:{}}),te=n.useRef({isDirty:!S,dirtyFields:!S,touchedFields:!S,isValidating:!S,isValid:!S,errors:!S}),ae=n.useRef(Z);G.current=u,J.current=t;const ie=()=>(ae.current.isValid=P(U.current,W.current)&&k(ae.current.errors),ae.current.isValid),le=n.useCallback(((e,r,t=!1,n={},s,u)=>{const a=d(ae.current.errors,e);if(r?(re(U.current,e),$(ae.current.errors,e,r)):((d(W.current,e)||J.current)&&$(U.current,e,!0),re(ae.current.errors,e)),(t||u||(r?!P(a,r,!0):a)||!k(n)||te.current.isValid&&ae.current.isValid!==(J.current?!!s:ie()))&&!c(t)){const r=Object.assign(Object.assign({},n),{isValid:J.current?!!s:ie(),errors:ae.current.errors,name:e});ae.current=Object.assign(Object.assign({},ae.current),r),A.current.next(u?{name:e}:r)}A.current.next({isValidating:!1})}),[]),fe=n.useCallback(((e,r,t={},n,u)=>{u&&Be(e);const a=d(x.current,e);if(a){const u=a._f;if(u){const a=_&&Ae(u.ref)&&c(r)?"":r;if(u.value=oe(r,u),ue(u.ref)?(u.refs||[]).forEach((e=>e.checked=e.value===a)):se(u.ref)&&!K(a)?u.ref.files=a:ce(u.ref)?[...u.ref.options].forEach((e=>e.selected=a.includes(e.value))):s(u.ref)&&u.refs?u.refs.length>1?u.refs.forEach((e=>e.checked=Array.isArray(a)?!!a.find((r=>r===e.value)):a===e.value)):u.refs[0].checked=!!a:u.ref.value=a,n){const t=M(x);$(t,e,r),C.current.next({values:Object.assign(Object.assign({},q.current),t),name:e})}t.shouldDirty&&ye(e,a),t.shouldValidate&&je(e)}else a._f={ref:{name:e,value:r},value:r}}}),[]),de=n.useCallback(((e,r)=>{const t=M(x);return e&&r&&$(t,e,r),!P(t,q.current)}),[]),ye=n.useCallback(((e,r,t=!0)=>{if(te.current.isDirty||te.current.dirtyFields){const n=!P(d(q.current,e),r),s=d(ae.current.dirtyFields,e),c=ae.current.isDirty;n?$(ae.current.dirtyFields,e,!0):re(ae.current.dirtyFields,e),ae.current.isDirty=de();const u={isDirty:ae.current.isDirty,dirtyFields:ae.current.dirtyFields,name:e},a=te.current.isDirty&&c!==u.isDirty||te.current.dirtyFields&&s!==d(ae.current.dirtyFields,e);return a&&t&&A.current.next(u),a?u:{}}return{}}),[]),he=n.useCallback((async(e,r)=>{const t=(await pe(d(x.current,e),Y))[e];return le(e,t,r),f(t)}),[Y]),ve=n.useCallback((async(e,r=[])=>{const{errors:t}=await J.current(M(x),G.current,{criteriaMode:v,names:r,fields:ne(O.current,x.current)});for(const r of e){const e=d(t,r);e?$(ae.current.errors,r,e):re(ae.current.errors,r)}return t}),[v]),xe=async e=>{let r=!0;for(const t in e){const n=e[t];if(n){const e=n._f,t=p(n,"_f");if(e){const t=await pe(n,Y);t[e.name]?(r=!1,$(ae.current.errors,e.name,t[e.name]),re(U.current,e.name)):d(W.current,e.name)&&($(U.current,e.name,!0),re(ae.current.errors,e.name))}t&&await xe(t)}}return r},je=n.useCallback((async e=>{const r=f(e)?Object.keys(x.current):F(e);let t,n={};return A.current.next({isValidating:!0}),J.current?(n=await ve(r,f(e)?void 0:r),t=r.every((e=>!d(n,e)))):t=f(e)?await xe(x.current):(await Promise.all(r.filter((e=>d(x.current,e))).map((async e=>await he(e,null))))).every(Boolean),A.current.next(Object.assign(Object.assign({},K(e)?{name:e}:{}),{errors:ae.current.errors,isValidating:!1,isValid:J.current?k(n):ie()})),t}),[ve,he]),Ve=n.useCallback(((e,r,t)=>Object.entries(r).forEach((([r,n])=>{const s=`${e}.${r}`,c=d(x.current,s);Q.current.has(e)||!L(n)||c&&!c._f?Ve(s,n,t):fe(s,n,t,!0,!c)}))),[je]),Fe=e=>z.current||N.current.has(e)||N.current.has((e.match(/\w+/)||[])[0]),_e=(e,r,t,n)=>{const s=d(x.current,e),c=f(s._f.value)?d(q.current,e):s._f.value;return s&&!f(c)&&(t&&t.defaultChecked?s._f.value=be(s):l(Q.current,e)?s._f.value=c:fe(e,c)),(!f(c)||n)&&ge(r,s._f.mount)&&!X.isOnSubmit&&s&&te.current.isValid&&pe(s,Y).then((r=>{k(r)?$(U.current,e,!0):re(U.current,e),ae.current.isValid!==ie()&&ee(Object.assign(Object.assign({},ae.current),{isValid:ie()}))})),c},Se=n.useCallback((async({type:e,target:t,target:{value:n,type:c}})=>{let u,a,l=t.name;const o=d(x.current,l);if(o){let g=c?be(o):void 0;g=f(g)?n:g;const m=e===b,{isOnBlur:y,isOnChange:h}=Oe(r),p=!ge(o._f,o._f.mount)&&!J.current&&!d(ae.current.errors,l)||(({isOnBlur:e,isOnChange:r,isOnTouch:t,isTouched:n,isReValidateOnBlur:s,isReValidateOnChange:c,isBlurEvent:u,isSubmitted:a,isOnAll:i})=>!i&&(!a&&t?!(n||u):(a?s:e)?!u:!(a?c:r)||u))(Object.assign({isBlurEvent:m,isTouched:!!d(ae.current.touchedFields,l),isSubmitted:ae.current.isSubmitted,isReValidateOnBlur:y,isReValidateOnChange:h},X)),O=!m&&Fe(l);f(g)||(o._f.value=g);const j=ye(l,o._f.value,!1);m&&!d(ae.current.touchedFields,l)&&($(ae.current.touchedFields,l,!0),te.current.touchedFields&&(j.touchedFields=ae.current.touchedFields));let V=!k(j)||O;if(p)return!m&&w.current.next({name:l,type:e,formValues:we()}),V&&A.current.next(O?{name:l}:Object.assign(Object.assign({},j),{name:l}));if(A.current.next({isValidating:!0}),J.current){const{errors:e}=await J.current(M(x),G.current,{criteriaMode:v,fields:ne([l],x.current),names:[l]}),r=ae.current.isValid;if(u=d(e,l),s(t)&&!u){const r=i(l),t=d(e,r,{});t.type&&t.message&&(u=t),(t||d(ae.current.errors,r))&&(l=r)}a=k(e),r!==a&&(V=!0)}else u=(await pe(o,Y))[l];!m&&w.current.next({name:l,type:e,formValues:we()}),le(l,u,V,j,a,O)}}),[]),we=e=>{const r=Object.assign(Object.assign({},q.current),M(x));return f(e)?r:K(e)?d(r,e):e.map((e=>d(r,e)))},Ce=n.useCallback((async(e={})=>{const r=ae.current.isValid;if(t){const{errors:r}=await J.current(Object.assign(Object.assign({},M(x)),e),G.current,{criteriaMode:v,fields:ne(O.current,x.current)});ae.current.isValid=k(r)}else ie();r!==ae.current.isValid&&A.current.next({isValid:ae.current.isValid})}),[v]),De=n.useCallback(((e,r,t,n)=>{const s=Array.isArray(e),c=n||(T.current?Object.assign(Object.assign({},q.current),M(x)):f(r)?q.current:s?r:{[e]:r});if(f(e))return t&&(z.current=!0),c;const u=[];for(const r of F(e))t&&N.current.add(r),u.push(d(c,r));return s?u:u[0]}),[]),Ee=(e,r={})=>{for(const t of e?F(e):Object.keys(O.current))O.current.delete(t),Q.current.delete(t),d(x.current,t)&&(r.keepIsValid||(re(W.current,t),re(U.current,t)),!r.keepError&&re(ae.current.errors,t),!r.keepValue&&re(x.current,t),!r.keepDirty&&re(ae.current.dirtyFields,t),!r.keepTouched&&re(ae.current.touchedFields,t),!h&&!r.keepDefaultValue&&re(q.current,t),w.current.next({name:t,formValues:we()}));A.current.next(Object.assign(Object.assign(Object.assign({},ae.current),r.keepDirty?{isDirty:de()}:{}),J.current?{}:{isValid:ie()})),!r.keepIsValid&&Ce()},Be=n.useCallback(((e,r)=>{const t=!d(x.current,e);return $(x.current,e,{_f:Object.assign(Object.assign(Object.assign({},t?{ref:{name:e}}:Object.assign({ref:(d(x.current,e)._f||{}).ref||{}},d(x.current,e)._f)),{name:e,mount:!0}),r)}),ge(r,!0)&&$(W.current,e,!0),O.current.add(e),t&&_e(e,r),Re?{name:e}:{name:e,onChange:Se,onBlur:Se,ref:t=>{if(t)((e,r,t)=>{Be(e,t);let n=d(x.current,e);const c=(e=>ue(e)||s(e))(r);if(r===n._f.ref||_&&Ae(n._f.ref)&&!Ae(r)||c&&Array.isArray(n._f.refs)&&o(n._f.refs).find((e=>e===r)))return;n={_f:c?Object.assign(Object.assign({},n._f),{refs:[...o(n._f.refs||[]).filter((e=>Ae(e)&&document.contains(e))),r],ref:{type:r.type,name:e}}):Object.assign(Object.assign({},n._f),{ref:r})},$(x.current,e,n);const u=_e(e,t,r,!0);(c&&Array.isArray(u)?!P(d(x.current,e)._f.value,u):f(d(x.current,e)._f.value))&&(d(x.current,e)._f.value=be(d(x.current,e)))})(e,t,r);else{const t=d(x.current,e),n=h||r&&r.shouldUnregister;t&&(t._f.mount=!1),_&&(l(Q.current,e)?n&&!B.current:n)&&j.current.add(e)}}}}),[q.current]),Ne=n.useCallback(((e,r)=>async t=>{t&&(t.preventDefault&&t.preventDefault(),t.persist&&t.persist());let n=!0,s=M(x);A.current.next({isSubmitting:!0});try{if(J.current){const{errors:e,values:r}=await J.current(s,G.current,{criteriaMode:v,fields:ne(O.current,x.current)});ae.current.errors=e,s=r}else await xe(x.current);k(ae.current.errors)&&Object.keys(ae.current.errors).every((e=>d(s,e)))?(A.current.next({errors:{},isSubmitting:!0}),await e(s,t)):(r&&await r(ae.current.errors,t),m&&I(x.current,(e=>d(ae.current.errors,e)),O.current))}catch(e){n=!1}finally{ae.current.isSubmitted=!0,A.current.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:k(ae.current.errors)&&n,submitCount:ae.current.submitCount+1,errors:ae.current.errors})}}),[m,Y,v]),$e=n.useCallback((({keepErrors:e,keepDirty:r,keepIsSubmitted:t,keepTouched:n,keepDefaultValues:s,keepIsValid:c,keepSubmitCount:u},a)=>{c||(U.current={},W.current={}),N.current=new Set,z.current=!1,A.current.next({submitCount:u?ae.current.submitCount:0,isDirty:r?ae.current.isDirty:!!s&&P(a,q.current),isSubmitted:!!t&&ae.current.isSubmitted,isValid:c?ae.current.isValid:!!Ce(a),dirtyFields:r?ae.current.dirtyFields:{},touchedFields:n?ae.current.touchedFields:{},errors:e?ae.current.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})}),[]),Ie=(e,r="")=>{const t=d(x.current,r);if(!t&&(L(e)||_&&(e instanceof File||e instanceof Date))&&$(x.current,r,{_f:{ref:{name:r,value:e},value:e,name:r}}),!(t&&t._f&&t._f.refs)&&(Array.isArray(e)||a(e))){r&&!d(x.current,r)&&$(x.current,r,Array.isArray(e)?[]:{});for(const t in e)Ie(e[t],r+(r?".":"")+t)}};return n.useEffect((()=>{Ie(q.current);const e=A.current.subscribe({next(e){R(e,te.current,!0)&&(ae.current=Object.assign(Object.assign({},ae.current),e),ee(ae.current))}}),r=D.current.subscribe({next(e){if(e.fields&&e.name&&te.current.isValid){const r=M(x);$(r,e.name,e.fields),Ce(r)}}});return J.current&&te.current.isValid&&Ce(),()=>{w.current.unsubscribe(),e.unsubscribe(),r.unsubscribe()}}),[]),n.useEffect((()=>{const e=e=>!Ae(e)||!document.contains(e);T.current=!0;for(const r of j.current){const t=d(x.current,r);t&&(t._f.refs?t._f.refs.every(e):e(t._f.ref))&&Ee(r)}j.current=new Set})),{control:n.useMemo((()=>({register:Be,isWatchAllRef:z,inFieldArrayActionRef:B,watchFieldsRef:N,getIsDirty:de,formStateSubjectRef:A,fieldArraySubjectRef:D,controllerSubjectRef:C,watchSubjectRef:w,watchInternal:De,fieldsRef:x,validFieldsRef:U,fieldsWithValidationRef:W,fieldArrayNamesRef:Q,readFormStateRef:te,formStateRef:ae,defaultValuesRef:q,fieldArrayDefaultValuesRef:E,unregister:Ee,shouldUnmount:h})),[]),formState:V(S,Z,te),trigger:je,register:Be,handleSubmit:Ne,watch:n.useCallback(((e,r)=>me(e)?w.current.subscribe({next:t=>e(De(void 0,r),t)}):De(e,r,!0)),[]),setValue:n.useCallback(((e,r,t={})=>{const n=d(x.current,e),s=Q.current.has(e);s&&(D.current.next({fields:r,name:e,isReset:!0}),(te.current.isDirty||te.current.dirtyFields)&&t.shouldDirty&&($(ae.current.dirtyFields,e,H(r,d(q.current,e,[]),d(ae.current.dirtyFields,e,[]))),A.current.next({name:e,dirtyFields:ae.current.dirtyFields,isDirty:de(e,r)})),!r.length&&$(x.current,e,[])&&$(E.current,e,[])),(n&&!n._f||s)&&!c(r)?Ve(e,r,s?{}:t):fe(e,r,t,!0,!n),Fe(e)&&A.current.next({}),w.current.next({name:e,formValues:we()})}),[Ve]),getValues:n.useCallback(we,[]),reset:n.useCallback(((e,r={})=>{const t=e||q.current;if(_&&!r.keepValues)for(const e of O.current){const r=d(x.current,e);if(r&&r._f){const e=Array.isArray(r._f.refs)?r._f.refs[0]:r._f.ref;try{Ae(e)&&e.closest("form").reset();break}catch(e){}}}!r.keepDefaultValues&&(q.current=Object.assign({},t)),r.keepValues||(x.current={},C.current.next({values:Object.assign({},t)}),w.current.next({formValues:Object.assign({},t)}),D.current.next({fields:Object.assign({},t),isReset:!0})),!r.keepDefaultValues&&Ie(Object.assign({},t)),$e(r,e)}),[]),clearErrors:n.useCallback((e=>{e?F(e).forEach((e=>re(ae.current.errors,e))):ae.current.errors={},A.current.next({errors:ae.current.errors})}),[]),unregister:n.useCallback(Ee,[]),setError:n.useCallback(((e,r,t)=>{const n=((d(x.current,e)||{_f:{}})._f||{}).ref;$(ae.current.errors,e,Object.assign(Object.assign({},r),{ref:n})),A.current.next({name:e,errors:ae.current.errors,isValid:!1}),t&&t.shouldFocus&&n&&n.focus&&n.focus()}),[]),setFocus:n.useCallback((e=>d(x.current,e)._f.ref.focus()),[])}}function _e(e){const{control:r,name:t,defaultValue:s}=e||{},c=A(),u=n.useRef(t);u.current=t;const{watchInternal:a,watchSubjectRef:i}=r||c.control,[l,o]=n.useState(f(s)?a(t):s);return n.useEffect((()=>{a(t);const e=i.current.subscribe({next:({name:e,formValues:r})=>(!u.current||!e||F(u.current).some((r=>e&&r&&(r.startsWith(e)||e.startsWith(r)))))&&o(a(u.current,s,!1,r))});return()=>e.unsubscribe()}),[]),l}}}]);